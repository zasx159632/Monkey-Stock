# ğŸµ Monkey Market Maven - Database Edition

<div align="center">

![Python](https://img.shields.io/badge/Python-3.9+-blue.svg)
![Discord.py](https://img.shields.io/badge/discord.py-2.3+-7289DA.svg)
![SQLite](https://img.shields.io/badge/SQLite-3-003B57.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

**è™›æ“¬è‚¡ç¥¨äº¤æ˜“æ©Ÿå™¨äºº - å®Œå…¨é‡æ§‹è³‡æ–™åº«ç‰ˆæœ¬**

ä¸€ç¾¤å®Œå…¨ä¸æœƒç¨‹å¼çš„æ¨‚å­äººï¼Œå¦„æƒ³é€é AI åšå‡ºè™›æ“¬äº¤æ˜“æ©Ÿå™¨äººã€‚
ç¾åœ¨æœ‰äº†å°ˆæ¥­çš„è³‡æ–™åº«æ¶æ§‹ï¼

</div>

---

## ğŸ¯ å°ˆæ¡ˆç‰¹è‰²

### âœ¨ æ–°ç‰ˆæœ¬äº®é»

- **ğŸ—„ï¸ SQLite è³‡æ–™åº«** - å–ä»£ CSV æª”æ¡ˆï¼Œæ›´ç©©å®šã€æ›´å¿«é€Ÿ
- **ğŸ§© æ¨¡çµ„åŒ–æ¶æ§‹** - ä½¿ç”¨ Discord.py Cogs çµ„ç¹”ç¨‹å¼ç¢¼
- **âš¡ éåŒæ­¥è™•ç†** - å®Œæ•´çš„ async/await æ¶æ§‹
- **ğŸ‘¤ ä½¿ç”¨è€…è¨­å®š** - æ¯å€‹ç”¨æˆ¶å¯è‡ªè¨‚äº¤æ˜“åå¥½
- **ğŸ“Š å®Œæ•´æ—¥èªŒ** - æ‰€æœ‰æ“ä½œéƒ½æœ‰å®Œæ•´ç´€éŒ„
- **ğŸ”’ è³‡æ–™å®Œæ•´æ€§** - ACID äº¤æ˜“ä¿è­‰

### ğŸ® æ ¸å¿ƒåŠŸèƒ½

1. **è™›æ“¬è‚¡ç¥¨äº¤æ˜“** - è²·å…¥ã€è³£å‡ºã€éš¨æ©Ÿé¸è‚¡
2. **æŠ•è³‡çµ„åˆç®¡ç†** - åº«å­˜è¿½è¹¤ã€æˆæœ¬èª¿æ•´
3. **æç›Šè¨ˆç®—** - è‡ªå‹•è¨ˆç®—æ‰‹çºŒè²»ã€è­‰äº¤ç¨…å’Œæç›Š
4. **çŒ´å­äº¤æ˜“ç³»çµ±** - åŠ æ¬Šéš¨æ©Ÿè‡ªå‹•äº¤æ˜“æ¨¡æ“¬
5. **å³æ™‚è‚¡åƒ¹æŸ¥è©¢** - å°ç£è­‰äº¤æ‰€ API æ•´åˆ

---

## ğŸ“‹ ç³»çµ±éœ€æ±‚

- Python 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- Discord Bot Token
- Google Cloud VM æˆ–ä»»ä½•æ”¯æ´ Python çš„ä¼ºæœå™¨

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å…‹éš†å°ˆæ¡ˆ

```bash
git clone https://github.com/yourusername/monkey-market-maven.git
cd monkey-market-maven
```

### 2. å®‰è£ç›¸ä¾å¥—ä»¶

```bash
pip install -r requirements.txt
```

### 3. è¨­å®šç’°å¢ƒè®Šæ•¸

å»ºç«‹ `.env` æª”æ¡ˆï¼š

```env
TOKEN=your_discord_bot_token_here
```

### 4. å»ºç«‹å°ˆæ¡ˆçµæ§‹

```bash
# å»ºç«‹å¿…è¦çš„ç›®éŒ„å’Œåˆå§‹åŒ–æª”æ¡ˆ
mkdir -p database cogs utils
touch database/__init__.py
touch cogs/__init__.py
touch utils/__init__.py
```

### 5. æ¸¬è©¦è³‡æ–™åº«

```bash
python test_database.py
```

å¦‚æœæ‰€æœ‰æ¸¬è©¦é€šéï¼Œæ‚¨çš„è³‡æ–™åº«è¨­å®šå°±å®Œæˆäº†ï¼

### 6. å•Ÿå‹•æ©Ÿå™¨äºº

```bash
python main.py
```

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
monkey-market-maven/
â”‚
â”œâ”€â”€ main.py                      # æ©Ÿå™¨äººä¸»ç¨‹å¼
â”œâ”€â”€ .env                         # ç’°å¢ƒè®Šæ•¸ (è«‹å‹¿æäº¤)
â”œâ”€â”€ .gitignore                   # Git å¿½ç•¥æª”æ¡ˆ
â”œâ”€â”€ requirements.txt             # Python å¥—ä»¶æ¸…å–®
â”œâ”€â”€ README.md                    # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
â”œâ”€â”€ ä¸Šå¸‚è‚¡ç¥¨.csv                  # å°ç£ä¸Šå¸‚è‚¡ç¥¨æ¸…å–®
â”‚
â”œâ”€â”€ database/                    # è³‡æ–™åº«å±¤
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ schema.py                # è³‡æ–™åº«æ¶æ§‹èˆ‡ç®¡ç†
â”‚
â”œâ”€â”€ cogs/                        # æŒ‡ä»¤æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ general.py               # å¹«åŠ©èˆ‡é€šç”¨æŒ‡ä»¤
â”‚   â”œâ”€â”€ trading.py               # è²·è³£äº¤æ˜“æŒ‡ä»¤
â”‚   â”œâ”€â”€ portfolio.py             # æŠ•è³‡çµ„åˆç®¡ç†
â”‚   â”œâ”€â”€ profit.py                # æç›Šè¿½è¹¤
â”‚   â”œâ”€â”€ monkey.py                # çŒ´å­äº¤æ˜“ç³»çµ±
â”‚   â””â”€â”€ settings.py              # ä½¿ç”¨è€…è¨­å®š
â”‚
â”œâ”€â”€ utils/                       # å·¥å…·å‡½å¼
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ stock_utils.py           # è‚¡ç¥¨è³‡æ–™è™•ç†
â”‚
â”œâ”€â”€ test_database.py             # è³‡æ–™åº«æ¸¬è©¦è…³æœ¬
â”œâ”€â”€ migrate_csv_to_db.py         # CSV è½‰è³‡æ–™åº«å·¥å…·
â”‚
â””â”€â”€ trading_bot.db               # SQLite è³‡æ–™åº« (è‡ªå‹•ç”Ÿæˆ)
```

---

## ğŸ’¾ è³‡æ–™åº«æ¶æ§‹

### è³‡æ–™è¡¨ç¸½è¦½

| è³‡æ–™è¡¨ | ç”¨é€” | é—œéµæ¬„ä½ |
|--------|------|----------|
| `portfolio` | æŒè‚¡åº«å­˜ | user_id, stock_code, shares, total_cost |
| `transactions` | äº¤æ˜“æ—¥èªŒ | user_id, timestamp, transaction_type, amount |
| `profit_loss` | æç›Šç´€éŒ„ | user_id, profit_loss, buy_price, sell_price |
| `user_settings` | ä½¿ç”¨è€…è¨­å®š | user_id, monkey_min_amount, monkey_weights |
| `pending_trades` | å¾…ç¢ºèªäº¤æ˜“ | user_id, stock_code, shares, price |
| `monkey_sell_state` | çŒ´å­è³£å‡ºç‹€æ…‹ | user_id, shares_to_sell, average_cost |

### è³‡æ–™æµç¨‹

```
èˆŠç‰ˆ CSV æµç¨‹:
User â†’ Command â†’ Read CSV â†’ Process â†’ Write CSV â†’ Response

æ–°ç‰ˆè³‡æ–™åº«æµç¨‹:
User â†’ Command â†’ Query DB â†’ Process â†’ Update DB â†’ Response
```

**å„ªå‹¢:**
- âœ… æ”¯æ´ä¸¦ç™¼å­˜å– (WAL æ¨¡å¼)
- âœ… è³‡æ–™å®Œæ•´æ€§ä¿è­‰ (ACID)
- âœ… è¤‡é›œæŸ¥è©¢èƒ½åŠ› (SQL)
- âœ… æ›´å¥½çš„æ•ˆèƒ½
- âœ… æ›´å®¹æ˜“ç¶­è­·

---

## ğŸ® æŒ‡ä»¤åˆ—è¡¨

### ğŸ“ˆ äº¤æ˜“æŒ‡ä»¤

| æŒ‡ä»¤ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| `!random` | éš¨æ©Ÿé¸è‚¡ä¸¦ç”¢ç”Ÿäº¤æ˜“ | `!random` |
| `!ry` | ç¢ºèªéš¨æ©Ÿäº¤æ˜“ | `!ry` |
| `!rn` | å–æ¶ˆéš¨æ©Ÿäº¤æ˜“ | `!rn` |
| `!buy <è‚¡ç¥¨> <è‚¡æ•¸> [åƒ¹æ ¼]` | è²·å…¥è‚¡ç¥¨ | `!buy 2330 10` æˆ– `!buy å°ç©é›» 10 600` |
| `!sell <è‚¡ç¥¨> <è‚¡æ•¸> [åƒ¹æ ¼]` | è³£å‡ºè‚¡ç¥¨ | `!sell 2330 5` æˆ– `!sell 0050 10 150` |

### ğŸ’¼ æŠ•è³‡çµ„åˆ

| æŒ‡ä»¤ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| `!summary` | é¡¯ç¤ºåº«å­˜æ‘˜è¦ | `!summary` |
| `!adjust_cost <è‚¡ç¥¨> <æ–°æˆæœ¬>` | èª¿æ•´æŒè‚¡æˆæœ¬ | `!adjust_cost 2330 580` |
| `!show [æ•¸é‡]` | é¡¯ç¤ºæœ€è¿‘æ“ä½œ | `!show` æˆ– `!show 10` |

### ğŸ’° æç›Šç®¡ç†

| æŒ‡ä»¤ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| `!profit` | æŸ¥çœ‹ç¸½å·²å¯¦ç¾æç›Š | `!profit` |
| `!profitclear` | æ¸…ç©ºæç›Šç´€éŒ„ | `!profitclear` |

### ğŸµ çŒ´å­äº¤æ˜“

| æŒ‡ä»¤ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| `!monkey [æœ€å°] [æœ€å¤§]` | è®“çŒ´å­éš¨æ©Ÿäº¤æ˜“ | `!monkey` æˆ– `!monkey 10000 50000` |
| `!usersetting` | æŸ¥çœ‹äº¤æ˜“è¨­å®š | `!usersetting` |
| `!usersetting amount <æœ€å°> <æœ€å¤§>` | è¨­å®šé‡‘é¡ç¯„åœ | `!usersetting amount 5000 30000` |
| `!usersetting weights <è²·> <è³£> <æŒæœ‰>` | è¨­å®šæ“ä½œæ¬Šé‡ | `!usersetting weights 40 30 30` |
| `!usersetting reset` | é‡ç½®ç‚ºé è¨­å€¼ | `!usersetting reset` |

### ğŸ“š å…¶ä»–æŒ‡ä»¤

| æŒ‡ä»¤ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| `!bothelp` | é¡¯ç¤ºå®Œæ•´èªªæ˜ | `!bothelp` |
| `!info` | æ©Ÿå™¨äººè³‡è¨Š | `!info` |
| `!ping` | æª¢æŸ¥å»¶é² | `!ping` |

---

## ğŸ’¡ ä½¿ç”¨ç¯„ä¾‹

### åŸºæœ¬äº¤æ˜“æµç¨‹

```
# 1. ä»¥å¸‚åƒ¹è²·å…¥å°ç©é›»
!buy 2330 10

# 2. ä»¥è‡ªè¨‚åƒ¹æ ¼è²·å…¥ 0050
!buy 0050 20 150

# 3. æŸ¥çœ‹åº«å­˜
!summary

# 4. è³£å‡ºè‚¡ç¥¨
!sell 2330 5

# 5. æŸ¥çœ‹æç›Š
!profit
